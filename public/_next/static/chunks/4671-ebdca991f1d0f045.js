(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4671],{62601:function(e,r,t){"use strict";var n,s;e.exports=(null==(n=t.g.process)?void 0:n.env)&&"object"==typeof(null==(s=t.g.process)?void 0:s.env)?t.g.process:t(58960)},24671:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return m}});var n=t(99891),s=t(56952),o=t.n(s),a=t(61396),i=t.n(a),c=t(24033),l=t(20955),u=t(56345),d=t(26705);function f(){var e,r,t=(0,c.usePathname)(),s=(0,l.useState)(!1),a=s[0],f=s[1],m=(0,l.useState)(null),h=m[0],p=m[1];(0,l.useEffect)(function(){var e;(e=(0,n.Z)(o().mark(function e(){var r,t;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.next=4;break;case 4:return e.next=6,fetch("/api/auth/check");case 6:if((r=e.sent).ok){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,r.json();case 11:(t=e.sent).user&&p(t.user),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error("Error fetching user info:",e.t0);case 18:case"end":return e.stop()}},e,null,[[0,15]])})),function(){return e.apply(this,arguments)})()},[]);var x=(e=(0,n.Z)(o().mark(function e(){var r;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=2;break}return e.abrupt("return");case 2:return f(!0),e.prev=3,r=(0,u.Ng)(),e.next=7,r.auth.signOut();case 7:return e.next=9,fetch("/api/auth/logout",{method:"POST"});case 9:if(e.sent.ok){e.next=12;break}throw Error("Logout failed");case 12:window.location.href="/admin/login",e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),console.error("Logout error:",e.t0);case 18:return e.prev=18,f(!1),e.finish(18);case 21:case"end":return e.stop()}},e,null,[[3,15,18,21]])})),function(){return e.apply(this,arguments)});return(0,d.jsxs)("aside",{className:"w-64 bg-gray-50 shadow-md flex flex-col h-screen",children:[(0,d.jsxs)("div",{className:"p-6",children:[(0,d.jsx)("h2",{className:"text-2xl font-semibold text-gray-900",children:"Eden Clinic"}),(0,d.jsx)("p",{className:"text-sm text-gray-800 font-medium",children:"Admin Dashboard"})]}),h&&(0,d.jsxs)("div",{className:"px-6 py-3 border-b border-gray-200 mb-2",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)("div",{className:"h-8 w-8 rounded-full bg-blue-600 flex items-center justify-center text-white font-medium",children:h.name?h.name.charAt(0).toUpperCase():h.email.charAt(0).toUpperCase()}),(0,d.jsxs)("div",{className:"overflow-hidden",children:[h.name&&(0,d.jsx)("p",{className:"text-sm font-medium truncate",children:h.name}),(0,d.jsx)("p",{className:"text-xs text-gray-500 truncate",title:h.email,children:(r=h.email).length>20?r.substring(0,17)+"...":r})]})]}),h.role&&(0,d.jsx)("div",{className:"mt-2",children:(0,d.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:h.role.replace("_"," ")})})]}),(0,d.jsxs)("nav",{className:"flex-1",children:[(0,d.jsx)(i(),{href:"/admin",className:"flex items-center px-6 py-3 text-gray-800 font-medium ".concat("/admin"===t?"bg-blue-50 border-r-4 border-blue-500 text-blue-700 font-semibold":"hover:bg-gray-50"),children:(0,d.jsx)("span",{className:"mx-4",children:"Dashboard"})}),(0,d.jsx)(i(),{href:"/admin/orders",className:"flex items-center px-6 py-3 text-gray-800 font-medium ".concat("/admin/orders"===t?"bg-blue-50 border-r-4 border-blue-500 text-blue-700 font-semibold":"hover:bg-gray-50"),children:(0,d.jsx)("span",{className:"mx-4",children:"Orders"})}),(0,d.jsx)(i(),{href:"/admin/users",className:"flex items-center px-6 py-3 text-gray-800 font-medium ".concat("/admin/users"===t?"bg-blue-50 border-r-4 border-blue-500 text-blue-700 font-semibold":"hover:bg-gray-50"),children:(0,d.jsx)("span",{className:"mx-4",children:"Users"})}),(0,d.jsx)(i(),{href:"/admin/test-results",className:"flex items-center px-6 py-3 text-gray-800 font-medium ".concat(t&&t.startsWith("/admin/test-results")?"bg-blue-50 border-r-4 border-blue-500 text-blue-700 font-semibold":"hover:bg-gray-50"),children:(0,d.jsx)("span",{className:"mx-4",children:"Test Results"})}),(null==h?void 0:h.role)==="SUPER_ADMIN"&&(0,d.jsx)(i(),{href:"/admin/google-users",className:"flex items-center px-6 py-3 text-gray-800 font-medium ".concat("/admin/google-users"===t?"bg-blue-50 border-r-4 border-blue-500 text-blue-700 font-semibold":"hover:bg-gray-50"),children:(0,d.jsx)("span",{className:"mx-4",children:"Google Users"})})]}),(0,d.jsx)("div",{className:"p-4 border-t border-gray-200",children:(0,d.jsx)("button",{onClick:x,disabled:a,className:"w-full flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 shadow-sm",children:a?"Logging out...":"Logout"})})]})}function m(e){var r=e.children;return"/admin/login"===(0,c.usePathname)()?(0,d.jsx)(d.Fragment,{children:r}):(0,d.jsx)("div",{className:"min-h-screen bg-gray-100",children:(0,d.jsxs)("div",{className:"flex h-screen",children:[(0,d.jsx)(f,{}),(0,d.jsxs)("div",{className:"flex-1 overflow-auto p-6",children:[(0,d.jsx)("h1",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Eden Clinic Admin"}),(0,d.jsx)("div",{className:"container",children:r})]})]})})}},56345:function(e,r,t){"use strict";t.d(r,{Ng:function(){return l},cT:function(){return u}});var n=t(99891),s=t(56952),o=t.n(s),a=t(82857),i=t(62601).env.SUPABASE_SERVICE_ROLE_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsemZobm53eXZkZGFvaWtydW5nIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc0Njg4OTA2OCwiZXhwIjoyMDYyNDY1MDY4fQ.qbO0KymO7nLymwexLcZ2SK4n1owTDU5U63DoNoIygTE",c=null;function l(){return c||(c=(0,a.eI)("https://dlzfhnnwyvddaoikrung.supabase.co",i)),c}function u(e,r){return d.apply(this,arguments)}function d(){return(d=(0,n.Z)(o().mark(function e(r,t){var n,s,a,i,c,u=arguments;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u.length>2&&void 0!==u[2]?u[2]:"test-results",e.prev=1,r){e.next=4;break}throw Error("No file provided for upload");case 4:if(t){e.next=6;break}throw Error("No storage path specified for upload");case 6:return console.log("Attempting to upload file to ".concat(n,"/").concat(t)),e.next=9,l().storage.from(n).upload(t,r,{cacheControl:"3600",upsert:!0});case 9:if(a=(s=e.sent).data,!(i=s.error)){e.next=15;break}throw console.error("Supabase upload error:",JSON.stringify(i)),Error("Error uploading file: ".concat(i.message));case 15:if(null!=a&&a.path){e.next=17;break}throw Error("Upload succeeded but no file path was returned");case 17:if(console.log("File uploaded successfully to ".concat(a.path)),null!=(c=l().storage.from(n).getPublicUrl(a.path).data)&&c.publicUrl){e.next=21;break}throw Error("Failed to generate public URL for uploaded file");case 21:return e.abrupt("return",c.publicUrl);case 24:throw e.prev=24,e.t0=e.catch(1),console.error("Error in uploadFile:",e.t0 instanceof Error?e.t0.message:"Unknown error"),console.error("Error details:",JSON.stringify(e.t0,null,2)),e.t0;case 29:case"end":return e.stop()}},e,null,[[1,24]])}))).apply(this,arguments)}},58960:function(e){!function(){var r={229:function(e){var r,t,n,s=e.exports={};function o(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function i(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{t="function"==typeof clearTimeout?clearTimeout:a}catch(e){t=a}}();var c=[],l=!1,u=-1;function d(){l&&n&&(l=!1,n.length?c=n.concat(c):u=-1,c.length&&f())}function f(){if(!l){var e=i(d);l=!0;for(var r=c.length;r;){for(n=c,c=[];++u<r;)n&&n[u].run();u=-1,r=c.length}n=null,l=!1,function(e){if(t===clearTimeout)return clearTimeout(e);if((t===a||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(e);try{t(e)}catch(r){try{return t.call(null,e)}catch(r){return t.call(this,e)}}}(e)}}function m(e,r){this.fun=e,this.array=r}function h(){}s.nextTick=function(e){var r=Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)r[t-1]=arguments[t];c.push(new m(e,r)),1!==c.length||l||i(f)},m.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=h,s.addListener=h,s.once=h,s.off=h,s.removeListener=h,s.removeAllListeners=h,s.emit=h,s.prependListener=h,s.prependOnceListener=h,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},t={};function n(e){var s=t[e];if(void 0!==s)return s.exports;var o=t[e]={exports:{}},a=!0;try{r[e](o,o.exports,n),a=!1}finally{a&&delete t[e]}return o.exports}n.ab="//";var s=n(229);e.exports=s}()},24033:function(e,r,t){e.exports=t(65367)}}]);