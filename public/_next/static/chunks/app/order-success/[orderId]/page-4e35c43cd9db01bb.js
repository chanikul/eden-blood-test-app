(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3708],{70468:function(){},71389:function(e,t,r){Promise.resolve().then(r.bind(r,10080))},10080:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return m}});var a=r(99891),n=r(56952),s=r.n(n),i=r(20955),c=r(24033),l=r(14059),d=r.g.prisma||new l.PrismaClient({log:["error","warn"],datasources:{db:{url:"postgresql://postgres.dlzfhnnwyvddaoikrung:DNE8ytm_uyw1jbc*qbr@aws-0-eu-west-2.pooler.supabase.com:5432/postgres"}}});function u(){return(u=(0,a.Z)(s().mark(function e(t){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",d.clientUser.findUnique({where:{email:t}}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}r(59520);var o=r(63715),p=r(26705);function m(e){return h.apply(this,arguments)}function h(){return(h=(0,a.Z)(s().mark(function e(t){var r,n,l,m,h,x,f;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.params.orderId,l=(n=(0,i.useState)(null))[0],m=n[1],x=(h=(0,i.useState)(null))[0],f=h[1],(0,i.useEffect)(function(){function e(){return(e=(0,a.Z)(s().mark(function e(){var t;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.order.findUnique({where:{id:r},select:{id:!0,patientName:!0,patientEmail:!0,testName:!0,status:!0,createdAt:!0,patientDateOfBirth:!0,client:{select:{id:!0}}}});case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return",(0,c.redirect)("/404"));case 6:if("PENDING"!==t.status){e.next=10;break}return e.abrupt("return",(0,c.redirect)("/500?error=payment_pending"));case 10:if("CANCELLED"!==t.status){e.next=12;break}return e.abrupt("return",(0,c.redirect)("/500?error=payment_cancelled"));case 12:if(!t.client){e.next=14;break}return e.abrupt("return",(0,c.redirect)("/client/account/orders/".concat(t.id)));case 14:return e.next=16,function(e){return u.apply(this,arguments)}(t.patientEmail);case 16:e.sent,m({patientName:t.patientName,patientEmail:t.patientEmail,testName:t.testName,status:t.status,id:t.id,createdAt:t.createdAt,patientDateOfBirth:t.patientDateOfBirth,client:t.client}),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(0),console.error("Error fetching order details:",e.t0),f("Failed to load order details");case 25:case"end":return e.stop()}},e,null,[[0,21]])}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[r]),!x){e.next=7;break}return e.abrupt("return",(0,p.jsx)("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center p-4",children:(0,p.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center",children:[(0,p.jsx)("p",{className:"text-red-600",children:x}),(0,p.jsx)("div",{className:"mt-4",children:(0,p.jsx)("a",{href:"/",className:"text-blue-600 hover:text-blue-800 transition-colors",children:"‚Üê Return to Home"})})]})}));case 7:if(l){e.next=9;break}return e.abrupt("return",(0,p.jsx)("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center p-4",children:(0,p.jsx)(o.Z,{className:"w-8 h-8 animate-spin text-blue-600"})}));case 9:return e.abrupt("return",(0,p.jsxs)("div",{className:"max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-md space-y-8",children:[(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsx)("div",{className:"text-green-600 mb-4",children:(0,p.jsx)("svg",{className:"w-16 h-16 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,p.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,p.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Order Confirmed!"}),(0,p.jsxs)("p",{className:"mb-2",children:["Thank you for your order, ",l.patientName,"."]}),(0,p.jsxs)("p",{className:"text-gray-600 mb-4",children:["Order ID: ",(0,p.jsx)("span",{className:"font-mono",children:l.id})]}),(0,p.jsxs)("div",{className:"text-left bg-gray-50 p-4 rounded-lg",children:[(0,p.jsx)("h3",{className:"font-semibold mb-2",children:"Order Details:"}),(0,p.jsxs)("p",{children:["Test: ",l.testName]}),(0,p.jsxs)("p",{children:["Date: ",new Date(l.createdAt).toLocaleDateString()]})]})]}),!l.client&&(0,p.jsxs)("div",{className:"border-t pt-8",children:[(0,p.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Create an Account"}),(0,p.jsx)("p",{className:"text-blue-700",children:"Create an account to track your order status and access your test results when they're ready."})]}),(0,p.jsxs)("form",{action:"/api/client/register",method:"POST",className:"space-y-4",children:[(0,p.jsx)("input",{type:"hidden",name:"email",value:l.patientEmail}),(0,p.jsx)("input",{type:"hidden",name:"name",value:l.patientName}),(0,p.jsx)("input",{type:"hidden",name:"dateOfBirth",value:l.patientDateOfBirth}),(0,p.jsx)("input",{type:"hidden",name:"orderId",value:l.id}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Choose a Password"}),(0,p.jsx)("input",{type:"password",id:"password",name:"password",required:!0,minLength:8,className:"block w-full rounded-md border-gray-300 shadow-sm",placeholder:"At least 8 characters"})]}),(0,p.jsx)("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors",children:"Create Account"})]})]})]}));case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}}},function(e){e.O(0,[5042,1722,4121,6531,1744],function(){return e(e.s=71389)}),_N_E=e.O()}]);