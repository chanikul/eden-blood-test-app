(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5920],{56784:function(e,r,t){Promise.resolve().then(t.bind(t,87102))},87102:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return m}});var n=t(99891),s=t(56952),a=t.n(s),o=t(20955),i=t(24033),c=t(82857),l=t(26705),u=(0,c.eI)("https://dlzfhnnwyvddaoikrung.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsemZobm53eXZkZGFvaWtydW5nIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY4ODkwNjgsImV4cCI6MjA2MjQ2NTA2OH0.wsXovBz2DzuZHRLOkoFJC821Tby6BRVXaottKJevAL8");function d(e){var r,t=e.email,s=e.onSuccess,c=(0,o.useState)(""),d=c[0],p=c[1],m=(0,o.useState)(""),f=m[0],h=m[1],x=(0,o.useState)(!1),b=x[0],g=x[1],v=(0,i.useRouter)(),y=(r=(0,n.Z)(a().mark(function e(r){var n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),g(!0),h(""),e.prev=3,e.next=6,u.auth.verifyOtp({email:t,token:d,type:"email"});case 6:if(!(n=e.sent.error)){e.next=10;break}throw n;case 10:s(),v.push("/admin"),v.refresh(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),h(e.t0.message||"OTP verification failed");case 18:return e.prev=18,g(!1),e.finish(18);case 21:case"end":return e.stop()}},e,null,[[3,15,18,21]])})),function(e){return r.apply(this,arguments)});return(0,l.jsxs)("form",{className:"space-y-6",onSubmit:y,children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"otp",className:"block text-sm font-medium text-gray-700",children:"Enter the 6-digit code sent to your email"}),(0,l.jsx)("input",{id:"otp",name:"otp",type:"text",inputMode:"numeric",autoComplete:"one-time-code",required:!0,maxLength:6,pattern:"\\\\d{6}",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:d,onChange:function(e){return p(e.target.value)}})]}),f&&(0,l.jsx)("div",{className:"text-red-600 text-sm",children:f}),(0,l.jsx)("button",{type:"submit",className:"w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none",disabled:b,children:b?"Verifying...":"Verify Code"})]})}var p=(0,c.eI)("https://dlzfhnnwyvddaoikrung.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsemZobm53eXZkZGFvaWtydW5nIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY4ODkwNjgsImV4cCI6MjA2MjQ2NTA2OH0.wsXovBz2DzuZHRLOkoFJC821Tby6BRVXaottKJevAL8");function m(){var e,r,t,s=(0,i.useRouter)(),c=(0,o.useState)(""),u=c[0],m=c[1],f=(0,o.useState)(!1),h=f[0],x=f[1],b=(0,o.useState)("login"),g=b[0],v=b[1],y=(0,o.useState)(""),w=y[0];y[1];var j=(0,o.useState)(!1),k=j[0],N=j[1];(0,o.useEffect)(function(){var e,r=p.auth.onAuthStateChange((e=(0,n.Z)(a().mark(function e(r,t){var n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!("SIGNED_IN"===r&&null!=t&&t.provider_token)){e.next=4;break}return n=t.provider_token,t.provider_refresh_token,e.next=4,C(n);case 4:case"end":return e.stop()}},e)})),function(r,t){return e.apply(this,arguments)})).data.subscription;return function(){r.unsubscribe()}},[]);var I=(e=(0,n.Z)(a().mark(function e(){var r,t;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,N(!0),m(""),e.next=7;break;case 7:return e.next=9,p.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/admin/login"),queryParams:{access_type:"offline",prompt:"consent"}}});case 9:if((r=e.sent).data,!(t=r.error)){e.next=14;break}throw t;case 14:e.next=21;break;case 16:e.prev=16,e.t0=e.catch(0),console.error("Google sign-in error:",e.t0),m(e.t0 instanceof Error?e.t0.message:"Google sign-in failed"),N(!1);case 21:case"end":return e.stop()}},e,null,[[0,16]])})),function(){return e.apply(this,arguments)}),C=(r=(0,n.Z)(a().mark(function e(r){var t,n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.next=5;break;case 5:return e.next=7,fetch("/api/auth/google",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:r})});case 7:return t=e.sent,e.next=10,t.json();case 10:if(n=e.sent,t.ok){e.next=13;break}throw Error(n.error||"Authentication failed");case 13:s.push("/admin"),e.next=21;break;case 16:e.prev=16,e.t0=e.catch(0),console.error("Google auth callback error:",e.t0),m(e.t0 instanceof Error?e.t0.message:"Authentication failed"),N(!1);case 21:case"end":return e.stop()}},e,null,[[0,16]])})),function(e){return r.apply(this,arguments)}),O=(t=(0,n.Z)(a().mark(function e(r){var t,n,o,i;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),x(!0),m(""),n=(t=new FormData(r.currentTarget)).get("email"),o=t.get("password"),e.prev=6,e.next=9,fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:o})});case 9:if((i=e.sent).ok){e.next=15;break}return e.next=13,i.json();case 13:throw Error(e.sent.error||"Login failed");case 15:s.push("/admin"),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),m(e.t0 instanceof Error?e.t0.message:"Login failed");case 21:return e.prev=21,x(!1),e.finish(21);case 24:case"end":return e.stop()}},e,null,[[6,18,21,24]])})),function(e){return t.apply(this,arguments)});return(0,l.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"max-w-md w-full space-y-8 p-8 bg-white rounded-lg shadow",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-center text-3xl font-extrabold text-gray-900",children:"Eden Clinic Admin"}),(0,l.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Please sign in with your Eden Clinic account"})]}),u&&(0,l.jsx)("div",{className:"text-red-600 text-sm text-center bg-red-50 p-3 rounded-md border border-red-200",children:u}),(0,l.jsxs)("div",{className:"mt-6",children:[(0,l.jsx)("button",{onClick:I,disabled:k,className:"w-full flex items-center justify-center gap-3 py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:k?(0,l.jsx)("span",{children:"Signing in..."}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 48 48",children:[(0,l.jsx)("path",{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),(0,l.jsx)("path",{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),(0,l.jsx)("path",{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),(0,l.jsx)("path",{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"})]}),(0,l.jsx)("span",{children:"Sign in with Google"})]})}),(0,l.jsx)("p",{className:"mt-2 text-xs text-center text-gray-500",children:"Only @edenclinicformen.com or @edenclinic.co.uk email addresses are allowed"})]}),(0,l.jsxs)("div",{className:"mt-6 relative",children:[(0,l.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,l.jsx)("div",{className:"w-full border-t border-gray-300"})}),(0,l.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,l.jsx)("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with password"})})]}),"login"===g?(0,l.jsxs)("form",{className:"mt-6 space-y-6",onSubmit:O,children:[(0,l.jsxs)("div",{className:"rounded-md shadow-sm -space-y-px",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"email",className:"sr-only",children:"Email address"}),(0,l.jsx)("input",{id:"email",name:"email",type:"email",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Email address"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"password",className:"sr-only",children:"Password"}),(0,l.jsx)("input",{id:"password",name:"password",type:"password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Password"})]})]}),(0,l.jsx)("div",{children:(0,l.jsx)("button",{type:"submit",className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:h,children:h?"Signing in...":"Sign in"})})]}):(0,l.jsx)(d,{email:w,onSuccess:function(){v("login")}})]})})}},69991:function(e,r,t){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=t(20955),s=Symbol.for("react.element"),a=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,r,t){var n,a={},l=null,u=null;for(n in void 0!==t&&(l=""+t),void 0!==r.key&&(l=""+r.key),void 0!==r.ref&&(u=r.ref),r)o.call(r,n)&&!c.hasOwnProperty(n)&&(a[n]=r[n]);if(e&&e.defaultProps)for(n in r=e.defaultProps)void 0===a[n]&&(a[n]=r[n]);return{$$typeof:s,type:e,key:l,ref:u,props:a,_owner:i.current}}r.Fragment=a,r.jsx=l,r.jsxs=l},26705:function(e,r,t){"use strict";e.exports=t(69991)},24033:function(e,r,t){e.exports=t(65367)}},function(e){e.O(0,[5350,2857,4121,6531,1744],function(){return e(e.s=56784)}),_N_E=e.O()}]);